<h1>사용자 통계</h1>
<p id="notice">
	<%= notice %>
</p>

<h2>유저 선택</h2>
<%= form_tag({:action => :user_stats}, {:method => 'get'}) do %>
<%= label_tag 'user_id', 'Select User:' %>
<%= select_tag 'user_id', options_from_collection_for_select(@users, "id", "username") %>
<%= submit_tag 'Show Stats' %>
<% end %>

<div id="stat_result">
	<% if @stats %>
	<h2 style="text-align: center; color: blue;"><%= @user.username %>'s Statistic</h2>

	<h3>Followings</h3>
	<ul>
		<% @followings.each do |following| %>
		<li>
			<%= link_to following.username, following %>
		</li>
		<% end %>
	</ul>

	<h3>Comment Logs</h3>
	<table class="comment_log">
		<caption>
			Comment Logs
		</caption>
		<tr>
			<th>Activity</th>
			<th>Target</th>
			<th>Created at</th>
		</tr>
		<% @comments.each do |comment, comment_type| %>
		<tr>
			<td><%= comment_type %></td>

			<% if comment_type.eql?('Following') %>
			<td>User: <%= link_to comment.followed.username, User.find(comment.followed_id), :target => "detail" %></td>
			<% else %>
			<td>UseCase: <%= link_to (comment.use_case.item + " / " + comment.use_case.purpose), comment.use_case, :target => "detail" %></td>
			<% end %>

			<td><%= l comment.created_at.in_time_zone("Seoul"), :format => :custom %></td>
		</tr>
		<% end %>
	</table>
	<% end %>
</div>

<!-- <b><%= debug @comments %></b> -->
